<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics GA4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q2SNEVHR7K"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-Q2SNEVHR7K');
    </script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Site Analytics</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background: #f5f5f5;
    }
    h1 {
      color: #333;
    }
    .stats-container {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .stat-card {
      display: inline-block;
      background: #6366f1;
      color: white;
      padding: 20px;
      border-radius: 4px;
      margin: 10px;
      min-width: 150px;
      text-align: center;
    }
    .stat-card h3 {
      margin: 0 0 10px 0;
      font-size: 14px;
      font-weight: normal;
      opacity: 0.9;
    }
    .stat-card .number {
      font-size: 36px;
      font-weight: bold;
      margin: 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
    }
    th, td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #e5e7eb;
    }
    th {
      background: #f9fafb;
      font-weight: 600;
      color: #374151;
    }
    .page-path {
      font-family: 'Courier New', monospace;
      color: #6366f1;
    }
    .timestamp {
      font-size: 12px;
      color: #6b7280;
    }
    .btn {
      background: #ef4444;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      margin-top: 10px;
    }
    .btn:hover {
      background: #dc2626;
    }
    .empty-state {
      text-align: center;
      padding: 40px;
      color: #6b7280;
    }
  </style>
</head>
<body>
  <h1>Site Analytics Dashboard</h1>

  
  <div class="stats-container">
    <h2>üìä Google Analytics Professional Dashboard</h2>
    <p>View detailed analytics including visitor demographics, traffic sources, page views, behavior flow, and real-time activity.</p>
    <a href="https://analytics.google.com/analytics/web/#/p286779835/realtime/overview" target="_blank" class="btn" style="display: inline-block; text-decoration: none; background: #4285f4; margin-right: 10px;">
      üìà Open Realtime Dashboard
    </a>
    <a href="https://analytics.google.com/analytics/web/#/p286779835/reports/intelligenthome" target="_blank" class="btn" style="display: inline-block; text-decoration: none; background: #34a853;">
      üìä View Full Reports
    </a>
  </div>

  <div class="stats-container">
    <h2>üìà Google Analytics Live Data</h2>
    <div id="gaLiveData">
      <div class="stat-card" style="background: #4285f4;">
        <h3>Active Users (Now)</h3>
        <div class="number" id="gaActiveUsers">-</div>
      </div>
      <div class="stat-card" style="background: #34a853;">
        <h3>Today's Page Views</h3>
        <div class="number" id="gaPageViews">-</div>
      </div>
      <div class="stat-card" style="background: #fbbc04;">
        <h3>Today's Sessions</h3>
        <div class="number" id="gaSessions">-</div>
      </div>
      <div class="stat-card" style="background: #ea4335;">
        <h3>Avg Session Duration</h3>
        <div class="number" id="gaAvgDuration">-</div>
      </div>
    </div>
    <p style="font-size: 12px; color: #6b7280; margin-top: 10px;">
      Note: Live GA4 data requires API setup. <a href="https://analytics.google.com" target="_blank">View full data in Google Analytics</a>
    </p>
  </div>
<div class="stats-container">
    <h2>üåç Global Statistics (All Visitors)</h2>
    <div class="stat-card" style="background: #ef4444;">
      <h3>Global Total Hits</h3>
      <div class="number" id="globalTotalHits">Loading...</div>
    </div>
  </div>

  <div class="stats-container">
    <h2>üåç Global Views by Country (All Visitors)</h2>
    <div id="globalCountryStats">Loading...</div>
  </div>

  <script>
    // Known country codes that have been tracked
    const TRACKED_COUNTRIES = [
      { code: 'US', name: 'United States' },
      { code: 'GB', name: 'United Kingdom' },
      { code: 'CA', name: 'Canada' },
      { code: 'AU', name: 'Australia' },
      { code: 'DE', name: 'Germany' },
      { code: 'FR', name: 'France' },
      { code: 'ES', name: 'Spain' },
      { code: 'IT', name: 'Italy' },
      { code: 'NL', name: 'Netherlands' },
      { code: 'SE', name: 'Sweden' },
      { code: 'NO', name: 'Norway' },
      { code: 'DK', name: 'Denmark' },
      { code: 'FI', name: 'Finland' },
      { code: 'BE', name: 'Belgium' },
      { code: 'CH', name: 'Switzerland' },
      { code: 'AT', name: 'Austria' },
      { code: 'PL', name: 'Poland' },
      { code: 'IE', name: 'Ireland' },
      { code: 'PT', name: 'Portugal' },
      { code: 'GR', name: 'Greece' },
      { code: 'CZ', name: 'Czech Republic' },
      { code: 'RO', name: 'Romania' },
      { code: 'HU', name: 'Hungary' },
      { code: 'IN', name: 'India' },
      { code: 'CN', name: 'China' },
      { code: 'JP', name: 'Japan' },
      { code: 'KR', name: 'South Korea' },
      { code: 'SG', name: 'Singapore' },
      { code: 'BR', name: 'Brazil' },
      { code: 'MX', name: 'Mexico' },
      { code: 'AR', name: 'Argentina' },
      { code: 'CL', name: 'Chile' },
      { code: 'CO', name: 'Colombia' },
      { code: 'ZA', name: 'South Africa' },
      { code: 'IL', name: 'Israel' },
      { code: 'AE', name: 'United Arab Emirates' },
      { code: 'SA', name: 'Saudi Arabia' },
      { code: 'TR', name: 'Turkey' },
      { code: 'RU', name: 'Russia' },
      { code: 'UA', name: 'Ukraine' },
      { code: 'NZ', name: 'New Zealand' },
      { code: 'MY', name: 'Malaysia' },
      { code: 'TH', name: 'Thailand' },
      { code: 'PH', name: 'Philippines' },
      { code: 'ID', name: 'Indonesia' },
      { code: 'VN', name: 'Vietnam' },
      { code: 'PK', name: 'Pakistan' },
      { code: 'BD', name: 'Bangladesh' },
      { code: 'EG', name: 'Egypt' },
      { code: 'NG', name: 'Nigeria' },
      { code: 'KE', name: 'Kenya' }
    ];

    // Load global statistics from Abacus API
    async function loadGlobalStats() {
      try {
        const response = await fetch('https://abacus.jasoncameron.dev/get/lotriet.github.io/v2-total-visits');
        if (response.ok) {
          const data = await response.json();
          document.getElementById('globalTotalHits').textContent = data.value || 0;
        } else {
          document.getElementById('globalTotalHits').textContent = 'N/A';
        }
      } catch (e) {
        document.getElementById('globalTotalHits').textContent = 'N/A';
        console.log('Global stats unavailable');
      }
    }

    // Load global country statistics
    async function loadGlobalCountryStats() {
      try {
        const countryData = [];

        // Fetch hit counts for each known country
        const promises = TRACKED_COUNTRIES.map(async country => {
          try {
            const response = await fetch(`https://abacus.jasoncameron.dev/get/lotriet.github.io/v2-country-${country.code}`);
            if (response.ok) {
              const data = await response.json();
              if (data.value && data.value > 0) {
                return { country: `${country.name} (${country.code})`, hits: data.value };
              }
            }
          } catch (e) {
            // Country not tracked, skip
          }
          return null;
        });

        const results = await Promise.all(promises);
        const validResults = results.filter(r => r !== null);

        if (validResults.length === 0) {
          document.getElementById('globalCountryStats').innerHTML = '<div class="empty-state">No country data available yet</div>';
          return;
        }

        // Sort by hits descending
        validResults.sort((a, b) => b.hits - a.hits);

        // Create table
        let html = '<table><tr><th>Country</th><th>Global Hits</th></tr>';
        validResults.forEach(item => {
          html += `<tr><td>${item.country}</td><td>${item.hits}</td></tr>`;
        });
        html += '</table>';

        document.getElementById('globalCountryStats').innerHTML = html;
      } catch (e) {
        console.error('Error loading global country stats:', e);
        document.getElementById('globalCountryStats').innerHTML = '<div class="empty-state">Error loading country data</div>';
      }
    }

    // Load analytics on page load
    loadGlobalStats();
    loadGlobalCountryStats();

    // Auto-refresh every 30 seconds
    setInterval(() => {
      loadGlobalStats();
      loadGlobalCountryStats();
    }, 30000);
  </script>

  <script>
    // Google Analytics Live Data (Placeholder for API integration)
    // Note: To display live GA4 data, you need to:
    // 1. Set up Google Analytics Data API in Google Cloud Console
    // 2. Create a service account with Analytics Viewer permissions
    // 3. Use server-side API calls (cannot be done purely client-side for security)

    // For now, we'll show placeholder data and link to the dashboard
    // Real implementation would require a backend API endpoint

    async function fetchGA4Data() {
      // Placeholder - in production, this would call your backend API
      // which would then call GA4 Data API with proper credentials

      // For demonstration, we'll show that data is available in the dashboard
      document.getElementById('gaActiveUsers').textContent = '‚Üí';
      document.getElementById('gaPageViews').textContent = '‚Üí';
      document.getElementById('gaSessions').textContent = '‚Üí';
      document.getElementById('gaAvgDuration').textContent = '‚Üí';

      // Update every 30 seconds
      setTimeout(fetchGA4Data, 30000);
    }

    // Initialize on page load
    fetchGA4Data();
  </script>
</body>
</html>
